
    <html>
    <head>
        <title>Pre-Flight QC Report</title>
        <style>
            body { font-family: sans-serif; margin: 2em; }
            h1, h2, h3 { color: #333; }
            table { border-collapse: collapse; width: 80%; margin: 1em 0; }
            th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
            th { background-color: #f2f2f2; }
            .summary-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(450px, 1fr)); gap: 20px; }
            .plot-container { border: 1px solid #ccc; padding: 10px; border-radius: 5px; }
            img { max-width: 100%; height: auto; }
        </style>
    </head>
    <body>
        <h1>Informe de Control de Calidad Previo (Pre-Flight QC)</h1>
        <p>Este informe resume los chequeos automáticos realizados sobre el dataset antes de la extracción de características.</p>
    <h2>1. Integridad y Alineación de Atlas</h2>
        <ul>
            <li>Geometría Coincidente (sin remuestreo): <b>False</b></li>
            <li>Dice Score (solapamiento de máscaras): <b>67.0436</b></li>
        </ul>
        <div class="plot-container">
            <h3>Chequeo Visual de Alineación</h3>
            <p>ROI 1 del atlas AAL3 superpuesto al atlas Yeo-17. Verificar que la ROI caiga en una región cortical plausible.</p>
            <img src="visual_atlas_alignment_check.png" alt="Visual Atlas Alignment Check">
        </div>
        <h2>2. Resumen de las Series Temporales</h2><h3>Primeros 10 Sujetos del Reporte</h3><table border="1" class="dataframe table table-striped">
  <thead>
    <tr style="text-align: right;">
      <th>subject_id</th>
      <th>file_found</th>
      <th>n_timepoints</th>
      <th>n_rois_raw</th>
      <th>is_transposed</th>
      <th>nan_count</th>
      <th>inf_count</th>
      <th>constant_rois_count</th>
      <th>low_variance_rois_indices</th>
      <th>error</th>
      <th>psd_plot_path</th>
      <th>percent_stationary_adf</th>
      <th>percent_stationary_kpss</th>
      <th>percent_stationary_joint</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0295</td>
      <td>True</td>
      <td>140</td>
      <td>170</td>
      <td>False</td>
      <td>560</td>
      <td>0</td>
      <td>4</td>
      <td>[34, 35, 80, 81]</td>
      <td>None</td>
      <td>/home/diego/Escritorio/desde_cero/mi_informe_qc/psd_0295.png</td>
      <td>90.588235</td>
      <td>97.647059</td>
      <td>90.588235</td>
    </tr>
    <tr>
      <td>0413</td>
      <td>True</td>
      <td>140</td>
      <td>170</td>
      <td>False</td>
      <td>560</td>
      <td>0</td>
      <td>4</td>
      <td>[34, 35, 80, 81]</td>
      <td>None</td>
      <td>/home/diego/Escritorio/desde_cero/mi_informe_qc/psd_0413.png</td>
      <td>93.529412</td>
      <td>97.647059</td>
      <td>93.529412</td>
    </tr>
    <tr>
      <td>0685</td>
      <td>True</td>
      <td>140</td>
      <td>170</td>
      <td>False</td>
      <td>560</td>
      <td>0</td>
      <td>4</td>
      <td>[34, 35, 80, 81]</td>
      <td>None</td>
      <td>/home/diego/Escritorio/desde_cero/mi_informe_qc/psd_0685.png</td>
      <td>92.941176</td>
      <td>97.647059</td>
      <td>92.941176</td>
    </tr>
    <tr>
      <td>0729</td>
      <td>True</td>
      <td>140</td>
      <td>170</td>
      <td>False</td>
      <td>560</td>
      <td>0</td>
      <td>4</td>
      <td>[34, 35, 80, 81]</td>
      <td>None</td>
      <td>/home/diego/Escritorio/desde_cero/mi_informe_qc/psd_0729.png</td>
      <td>97.058824</td>
      <td>97.647059</td>
      <td>97.058824</td>
    </tr>
    <tr>
      <td>1155</td>
      <td>True</td>
      <td>197</td>
      <td>170</td>
      <td>False</td>
      <td>788</td>
      <td>0</td>
      <td>4</td>
      <td>[34, 35, 80, 81]</td>
      <td>None</td>
      <td>/home/diego/Escritorio/desde_cero/mi_informe_qc/psd_1155.png</td>
      <td>97.647059</td>
      <td>97.647059</td>
      <td>97.647059</td>
    </tr>
    <tr>
      <td>2010</td>
      <td>True</td>
      <td>140</td>
      <td>170</td>
      <td>False</td>
      <td>560</td>
      <td>0</td>
      <td>4</td>
      <td>[34, 35, 80, 81]</td>
      <td>None</td>
      <td>/home/diego/Escritorio/desde_cero/mi_informe_qc/psd_2010.png</td>
      <td>89.411765</td>
      <td>97.647059</td>
      <td>89.411765</td>
    </tr>
    <tr>
      <td>2043</td>
      <td>True</td>
      <td>140</td>
      <td>170</td>
      <td>False</td>
      <td>560</td>
      <td>0</td>
      <td>4</td>
      <td>[34, 35, 80, 81]</td>
      <td>None</td>
      <td>/home/diego/Escritorio/desde_cero/mi_informe_qc/psd_2043.png</td>
      <td>86.470588</td>
      <td>97.647059</td>
      <td>86.470588</td>
    </tr>
    <tr>
      <td>2073</td>
      <td>True</td>
      <td>140</td>
      <td>170</td>
      <td>False</td>
      <td>560</td>
      <td>0</td>
      <td>4</td>
      <td>[34, 35, 80, 81]</td>
      <td>None</td>
      <td>/home/diego/Escritorio/desde_cero/mi_informe_qc/psd_2073.png</td>
      <td>93.529412</td>
      <td>97.647059</td>
      <td>93.529412</td>
    </tr>
    <tr>
      <td>4171</td>
      <td>True</td>
      <td>140</td>
      <td>170</td>
      <td>False</td>
      <td>560</td>
      <td>0</td>
      <td>4</td>
      <td>[34, 35, 80, 81]</td>
      <td>None</td>
      <td>/home/diego/Escritorio/desde_cero/mi_informe_qc/psd_4171.png</td>
      <td>81.764706</td>
      <td>97.647059</td>
      <td>81.764706</td>
    </tr>
    <tr>
      <td>4213</td>
      <td>True</td>
      <td>140</td>
      <td>170</td>
      <td>False</td>
      <td>560</td>
      <td>0</td>
      <td>4</td>
      <td>[34, 35, 80, 81]</td>
      <td>None</td>
      <td>/home/diego/Escritorio/desde_cero/mi_informe_qc/psd_4213.png</td>
      <td>83.529412</td>
      <td>97.647059</td>
      <td>83.529412</td>
    </tr>
  </tbody>
</table>
    <h3>Visualizaciones del Dataset Completo</h3>
    <div class="summary-grid">
        <div class="plot-container">
            <h4>Distribución de Timepoints</h4>
            <img src="summary_tp_countplot.png" alt="Timepoints Count Plot">
        </div>
        <div class="plot-container">
            <h4>Estacionariedad de ROIs</h4>
            <img src="summary_stationarity_boxplot.png" alt="Stationarity Boxplot">
        </div>
        <div class="plot-container">
            <h4>ROIs con Varianza Nula</h4>
            <img src="summary_low_variance_histogram.png" alt="Low Variance Histogram">
        </div>
        <div class="plot-container">
            <h4>Resumen de NaNs/Infs</h4>
            <p>Total de sujetos con valores NaN en sus series: <b>437</b></p><p>Total de sujetos con valores Inf en sus series: <b>0</b></p>
        </div>
    </div>
    <h2>3. Ejemplos de PSD de Sujetos Aleatorios</h2><div class='summary-grid'>
        <div class="plot-container">
            <h4>Sujeto: 6600</h4>
            <img src="psd_6600.png" alt="PSD Plot for 6600">
        </div>
        
        <div class="plot-container">
            <h4>Sujeto: 2402</h4>
            <img src="psd_2402.png" alt="PSD Plot for 2402">
        </div>
        
        <div class="plot-container">
            <h4>Sujeto: 2245</h4>
            <img src="psd_2245.png" alt="PSD Plot for 2245">
        </div>
        
        <div class="plot-container">
            <h4>Sujeto: 6284</h4>
            <img src="psd_6284.png" alt="PSD Plot for 6284">
        </div>
        </div></body></html>